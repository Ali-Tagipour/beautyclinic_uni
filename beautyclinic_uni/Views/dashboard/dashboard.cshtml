<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>داشبورد کلینیک زیبایی</title>

    <!-- فونت Vazirmatn -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- استایل جدا شده -->
    <link rel="stylesheet" href="style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="wrap" role="application" aria-label="داشبورد کلینیک زیبایی">
        <header>
            <h1>داشبورد کلینیک زیبایی</h1>
            <div class="role-actions">
                <button id="btnUser" class="role-btn">ورد کاربر</button>
                <button id="btnDoctor" class="role-btn secondary">ورود پزشک</button>
            </div>
        </header>

        <div class="layout">
            <aside class="sidebar" aria-label="منوی داشبورد">
                <div id="sidebarTitle"><h3>خوش آمدید</h3></div>

                <ul id="userMenu" class="menu" style="display:none;">
                    <li>اطلاعات کاربر <button onclick="showSection('userInfo')">مشاهده</button></li>
                    <li>رزرو نوبت <button onclick="showSection('appointment')">مشاهده</button></li>
                    <li>خدمات <button onclick="showSection('services')">مشاهده</button></li>
                    <li>پیگیری درمان <button onclick="showSection('tracking')">مشاهده</button></li>
                    <li>مشاوره <button onclick="showSection('consultation')">مشاهده</button></li>
                </ul>

                <ul id="doctorMenu" class="menu" style="display:none;">
                    <li>اطلاعات پزشک <button onclick="showSection('doctorInfo')">مشاهده</button></li>
                    <li>مدیریت نوبت‌ها <button onclick="showSection('doctorAppointments')">مشاهده</button></li>
                    <li>پرونده بیماران <button onclick="showSection('doctorPatients')">مشاهده</button></li>
                    <li>گزارش مالی <button onclick="showSection('doctorFinance')">مشاهده</button></li>
                </ul>
            </aside>

            <main class="main" id="mainArea">
                <section id="welcome" class="panel active" aria-hidden="false">
                    <h4>خوش آمدید</h4>
                    <p class="muted-text">نقش خود را انتخاب کنید تا منوها و بخش‌های مرتبط نمایش داده شوند.</p>
                </section>

                <!-- اطلاعات کاربر -->
                <section id="userInfo" class="panel" aria-hidden="true">
                    <h4>اطلاعات کاربر</h4>

                    <div id="userView" class="info-card" style="display:none;">
                        <div class="info-row"><strong>نام:</strong><span id="v_userName">—</span></div>
                        <div class="info-row"><strong>شماره تماس:</strong><span id="v_userPhone">—</span></div>
                        <div class="info-row"><strong>ایمیل:</strong><span id="v_userEmail">—</span></div>
                        <div class="info-row"><strong>آدرس:</strong><span id="v_userAddress">—</span></div>
                        <div class="actions">
                            <button class="btn-primary" onclick="toggleUserEdit(true)">ویرایش</button>
                            <button class="btn-warning" onclick="resetUserInfo()">بازنشانی</button>
                            <button class="btn-danger" onclick="clearUserInfo()">پاک‌سازی</button>
                        </div>
                    </div>

                    <form id="userForm" class="info-card" style="display:none;">
                        <label>نام</label><input id="userName" type="text" required />
                        <label>شماره تماس</label><input id="userPhone" type="text" />
                        <label>ایمیل</label><input id="userEmail" type="email" />
                        <label>آدرس</label><textarea id="userAddress"></textarea>
                        <div class="actions">
                            <button class="btn-primary" type="submit">ذخیره</button>
                            <button class="btn-ghost" type="button" onclick="toggleUserEdit(false)">انصراف</button>
                            <button class="btn-warning" type="button" onclick="resetUserForm()">بازنشانی فرم</button>
                        </div>
                    </form>
                </section>

                <!-- اطلاعات پزشک -->
                <section id="doctorInfo" class="panel" aria-hidden="true">
                    <h4>اطلاعات پزشک</h4>

                    <div id="doctorView" class="info-card" style="display:none;">
                        <div class="info-row"><strong>نام:</strong><span id="v_doctorName">—</span></div>
                        <div class="info-row"><strong>تخصص:</strong><span id="v_doctorSpecialty">—</span></div>
                        <div class="info-row"><strong>شماره تماس:</strong><span id="v_doctorPhone">—</span></div>
                        <div class="info-row"><strong>ایمیل:</strong><span id="v_doctorEmail">—</span></div>
                        <div class="actions">
                            <button class="btn-primary" onclick="toggleDoctorEdit(true)">ویرایش</button>
                            <button class="btn-warning" onclick="resetDoctorInfo()">بازنشانی</button>
                            <button class="btn-danger" onclick="clearDoctorInfo()">پاک‌سازی</button>
                        </div>
                    </div>

                    <form id="doctorForm" class="info-card" style="display:none;">
                        <label>نام</label><input id="doctorName" type="text" required />
                        <label>تخصص</label><input id="doctorSpecialty" type="text" />
                        <label>شماره تماس</label><input id="doctorPhone" type="text" />
                        <label>ایمیل</label><input id="doctorEmail" type="email" />
                        <div class="actions">
                            <button class="btn-primary" type="submit">ذخیره</button>
                            <button class="btn-ghost" type="button" onclick="toggleDoctorEdit(false)">انصراف</button>
                            <button class="btn-warning" type="button" onclick="resetDoctorForm()">بازنشانی فرم</button>
                        </div>
                    </form>
                </section>

                <!-- رزرو نوبت -->
                <section id="appointment" class="panel" aria-hidden="true">
                    <h4>رزرو نوبت</h4>
                    <form id="appointmentForm">
                        <label>نام و نام خانوادگی</label>
                        <input id="ap_name" type="text" required placeholder="مثال: مریم احمدی" />
                        <div class="row">
                            <div class="col">
                                <label>تاریخ</label>
                                <input id="ap_date" type="date" required />
                            </div>
                            <div class="col">
                                <label>ساعت</label>
                                <input id="ap_time" type="time" required />
                            </div>
                        </div>
                        <label>خدمت</label>
                        <select id="ap_service" required></select>
                        <label>توضیحات (اختیاری)</label>
                        <textarea id="ap_note"></textarea>
                        <div class="actions">
                            <button class="btn-primary" type="submit">ثبت نوبت</button>
                            <button class="btn-ghost" type="button" onclick="showSection('welcome')">انصراف</button>
                        </div>

                        <h4 style="margin-top:18px">نوبت‌های من</h4>
                        <table>
                            <thead><tr><th>نام</th><th>تاریخ</th><th>ساعت</th><th>خدمت</th><th>وضعیت</th><th>عملیات</th></tr></thead>
                            <tbody id="myApptsBody"></tbody>
                        </table>
                    </form>
                </section>

                <!-- خدمات (پرداخت داخل هر ردیف) -->
                <section id="services" class="panel" aria-hidden="true">
                    <h4>خدمات زیبایی</h4>
                    <table>
                        <thead><tr><th>خدمت</th><th>توضیح</th><th>قیمت</th><th>پرداخت</th></tr></thead>
                        <tbody id="servicesBody"></tbody>
                    </table>
                </section>

                <!-- پرداخت -->
                <section id="payment" class="panel" aria-hidden="true">
                    <h4>پرداخت آنلاین</h4>
                    <form id="paymentForm">
                        <label>نام بیمار</label>
                        <select id="pay_patient" required></select>

                        <label>پزشک</label>
                        <select id="pay_doctor" required></select>

                        <label>مبلغ (تومان)</label>
                        <input id="pay_amount" type="number" required />

                        <label>شرح پرداخت</label>
                        <input id="pay_desc" type="text" readonly />

                        <label>شماره کارت</label>
                        <input id="pay_card" type="text" required placeholder="16 رقم" />

                        <div class="row">
                            <div class="col">
                                <label>CVV2</label>
                                <input id="pay_cvv" type="text" required />
                            </div>
                            <div class="col">
                                <label>تاریخ انقضا</label>
                                <input id="pay_exp" type="month" required />
                            </div>
                        </div>

                        <div class="actions">
                            <button class="btn-primary" type="submit">پرداخت</button>
                            <button class="btn-ghost" type="button" onclick="showSection('services')">بازگشت به خدمات</button>
                        </div>
                        <div id="paymentMsg" style="margin-top:10px;color:green;display:none;"></div>
                    </form>
                </section>

                <!-- پیگیری درمان -->
                <section id="tracking" class="panel" aria-hidden="true">
                    <h4>پیگیری درمان</h4>
                    <table>
                        <thead><tr><th>جلسه</th><th>تاریخ</th><th>وضعیت</th></tr></thead>
                        <tbody id="trackingBody"></tbody>
                    </table>
                </section>

                <!-- مشاوره -->
                <section id="consultation" class="panel" aria-hidden="true">
                    <h4>مشاوره آنلاین</h4>
                    <form id="consultForm">
                        <label>موضوع</label>
                        <input id="cons_subject" type="text" required />
                        <label>پیام</label>
                        <textarea id="cons_message" required></textarea>
                        <div class="actions">
                            <button class="btn-primary" type="submit">ارسال</button>
                            <button class="btn-ghost" type="button" onclick="showSection('welcome')">انصراف</button>
                        </div>
                        <div id="consultMsg" style="margin-top:10px;color:green;display:none;"></div>
                    </form>
                </section>

                <!-- مدیریت نوبت‌ها -->
                <section id="doctorAppointments" class="panel" aria-hidden="true">
                    <h4>مدیریت نوبت‌ها</h4>
                    <table>
                        <thead><tr><th>نام بیمار</th><th>تاریخ</th><th>ساعت</th><th>خدمت</th><th>وضعیت</th><th>عملیات</th></tr></thead>
                        <tbody id="docApptsBody"></tbody>
                    </table>
                </section>

                <!-- پرونده بیماران -->
                <section id="doctorPatients" class="panel" aria-hidden="true">
                    <h4>پرونده بیماران</h4>
                    <table>
                        <thead><tr><th>نام بیمار</th><th>سن</th><th>خدمت</th><th>وضعیت</th><th>عملیات</th></tr></thead>
                        <tbody id="patientsBody"></tbody>
                    </table>
                    <div id="patientDetail" style="margin-top:12px; display:none; background:#fff; padding:12px; border-radius:10px;">
                        <h5 id="pdName" style="margin:0 0 6px 0;"></h5>
                        <p id="pdInfo" style="margin:0; color:var(--text-soft)"></p>
                        <div id="patientEditArea" style="margin-top:8px"></div>
                    </div>
                </section>

                <!-- گزارش مالی -->
                <section id="doctorFinance" class="panel" aria-hidden="true">
                    <h4>گزارش مالی</h4>

                    <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:10px;">
                        <label class="muted-text">بازه نمونه:</label>
                        <select id="periodSelect">
                            <option value="current">ماه جاری (نمونه)</option>
                            <option value="previous">ماه قبل (نمونه)</option>
                        </select>

                        <label class="muted-text">تاریخ شروع</label>
                        <input id="dateStart" type="date" />

                        <label class="muted-text">تاریخ پایان</label>
                        <input id="dateEnd" type="date" />

                        <label class="muted-text">فیلتر پزشک:</label>
                        <select id="doctorFilter">
                            <option value="">همه پزشکان</option>
                        </select>

                        <label class="muted-text">فیلتر خدمت:</label>
                        <select id="serviceFilter">
                            <option value="">همه خدمات</option>
                        </select>

                        <button id="refreshBtn" class="btn-primary">بروزرسانی گزارش</button>
                    </div>

                    <h4 style="margin-top:8px">فهرست پرداخت‌ها</h4>
                    <table>
                        <thead><tr><th>ردیف</th><th>تاریخ</th><th>نام بیمار</th><th>خدمت</th><th>پزشک</th><th>مبلغ (تومان)</th></tr></thead>
                        <tbody id="paymentsTableBody"></tbody>
                    </table>

                    <h4 style="margin-top:14px">خلاصه درآمد بر اساس پزشک</h4>
                    <div id="doctorSummary" class="summary"></div>

                    <div class="chart-wrap">
                        <div class="chart-card">
                            <h4 style="margin:0 0 8px 0;font-size:14px">نمودار مقایسه درآمد پزشکان</h4>
                            <canvas id="doctorBarChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4 style="margin:0 0 8px 0;font-size:14px">سهم هر خدمت (ماه جاری)</h4>
                            <canvas id="servicePieChart"></canvas>
                        </div>
                    </div>

                    <h4 style="margin-top:14px">تفکیک درآمد بر اساس نوع خدمت</h4>
                    <table>
                        <thead><tr><th>خدمت</th><th>تعداد پرداخت</th><th>جمع مبلغ (تومان)</th><th>پزشکان مرتبط</th></tr></thead>
                        <tbody id="serviceBreakBody"></tbody>
                    </table>
                </section>
            </main>
        </div>
    </div>

    <!-- اسکریپت جدا شده -->
    <script src="script.js"></script>
</body>
</html>
